<!DOCTYPE html>
<html>
    <head>
        <script src="/socket.io/socket.io.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
        <script type="text/javascript">
            $(document).ready(function(){
				var socketio = io.connect("10.0.0.104:1337");
				
				$("#chat").hide();
				$("#name").focus();
				$("form").submit(function(event){
					event.preventDefault();
				});
				
				socketio.on("update", function(msg) {
					if(ready)
						$("#msgs").append("<br/>" + msg + "");
				})

				socketio.on("update-people", function(people){
					if(ready) {
						$("#people").empty();
						$.each(people, function(clientid, name) {
							$('#people').append("<br/>" + name + "");
						});
					}
				});

				socketio.on("chat", function(who, msg){
					if(ready) {
						$("#msgs").append("<br/>" + who + " says: " + msg + "");
					}
				});

				socketio.on("disconnect", function(msg){
					$("#msgs").append("<br/>" + msg);
					//$("#msg").attr("disabled", "disabled");
					//$("#send").attr("disabled", "disabled");
					$("#login").show();
					$("#chat").hide();
				});
				
				$("#join").click(function(){
					var name = $("#name").val();
					if (name != "") {
						socketio.emit("join", name );
						$("#login").hide();//detach();
						$("#chat").show();
						$("#msg").focus();
						ready = true;
					}
				});
				//If user press enter
				$("#name").keypress(function(e){
					if(e.which == 13) {
						$("#join").click();
					}
				});
				
				$("#send").click(function(){
					var msg = $("#msg").val();
					if (msg != ""){
						socketio.emit("send", msg);
						$("#msg").val("");
					}
				});

				$("#msg").keypress(function(e){
					if(e.which == 13) {
						$("#send").click();
					}
				});
				
				$("#logoff").click(function(){
					socketio.emit("disconnect");
				});
			})
        </script>
    </head>
    <body>
        <div class="container">
		  <div class="span2">
			  <ul id="people" class="unstyled"></ul>
		  </div>
		  <div class="span4">
			  <ul id="msgs" class="unstyled">
		  </div>
		</div>
		
		<div class="container">
			<div class="span5 offset2" id="login">
				<form class="form-inline">
					<input type="text" class="input-small" placeholder="Your name" id="name">
					<input type="button" name="join" id="join" value="Join" class="btn btn-primary">
				</form>
			</div>
			
			<div class="span5 offset2" id="chat">
				<form id="2" class="form-inline">
					<input type="text" class="input" placeholder="Your message" id="msg">
					<input type="button" name="send" id="send" value="Send" class="btn btn-success">
					<input type="button" name="logoff" id="logoff" value="Disconnect" class="btn btn-danger">
				</form>
			</div>
		</div>
    </body>
</html>